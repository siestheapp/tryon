{
  "_meta": {
    "description": "Structured feature list for long-running agent sessions. Features marked 'failing' until verified working.",
    "rules": [
      "NEVER remove or edit a feature - only change status",
      "NEVER mark 'passing' without end-to-end verification",
      "Work on ONE feature per session",
      "Commit after each feature completion"
    ],
    "statuses": {
      "failing": "Not yet implemented or not verified",
      "in_progress": "Currently being worked on",
      "passing": "Implemented AND verified working",
      "blocked": "Cannot proceed - see notes"
    },
    "last_updated": "2025-12-21",
    "updated_by": "Claude Code (Session 12)"
  },

  "phase_1_app_store": {
    "description": "Get on App Store - 5 day deadline",
    "priority": "P0",
    "features": [
      {
        "id": "p1-001",
        "name": "TestFlight build submitted",
        "status": "passing",
        "verified_date": "2025-12-20",
        "notes": "Build #6, v1.0.0 submitted"
      },
      {
        "id": "p1-002",
        "name": "Test on physical device via TestFlight",
        "status": "passing",
        "verified_date": "2025-12-22",
        "notes": "Verified working on physical device"
      },
      {
        "id": "p1-003",
        "name": "App icon (1024x1024)",
        "status": "passing",
        "verified_date": "2025-12-22",
        "notes": "2048x2048 icon2.png - fs monogram with teal-blue gradient"
      },
      {
        "id": "p1-004",
        "name": "App Store screenshots (6.7\" and 5.5\")",
        "status": "passing",
        "verified_date": "2025-12-22",
        "notes": "6.7\" screenshots captured from iPhone 16 Pro simulator"
      },
      {
        "id": "p1-005",
        "name": "Privacy policy URL",
        "status": "passing",
        "verified_date": "2025-12-22",
        "notes": "https://freestylefit.net/appstore/privacy-policy.html"
      },
      {
        "id": "p1-006",
        "name": "App Store metadata (description, keywords, category)",
        "status": "passing",
        "verified_date": "2025-12-22",
        "notes": "docs/appstore/APP_STORE_CONNECT_METADATA.md - ready to paste"
      },
      {
        "id": "p1-007",
        "name": "Submit for App Store review",
        "status": "passing",
        "verified_date": "2025-12-23",
        "notes": "Build #9 submitted - iPhone only"
      }
    ]
  },

  "phase_1_core_features": {
    "description": "Core app functionality",
    "priority": "P0",
    "features": [
      {
        "id": "core-001",
        "name": "Scan tab - paste URL and lookup product",
        "status": "passing",
        "verified_date": "2025-12-20",
        "notes": "Verified in simulator"
      },
      {
        "id": "core-002",
        "name": "Confirm screen - color selection",
        "status": "passing",
        "verified_date": "2025-12-20",
        "notes": "Working with 100px swatches"
      },
      {
        "id": "core-003",
        "name": "Confirm screen - fit type selection",
        "status": "passing",
        "verified_date": "2025-12-20",
        "notes": "Added 2025-12-19"
      },
      {
        "id": "core-004",
        "name": "Confirm screen - size selection",
        "status": "passing",
        "verified_date": "2025-12-20",
        "notes": "Shows human-readable sizes"
      },
      {
        "id": "core-005",
        "name": "Confirm screen - fit rating with body parts",
        "status": "passing",
        "verified_date": "2025-12-20",
        "notes": ""
      },
      {
        "id": "core-006",
        "name": "Confirm screen - save try-on to database",
        "status": "passing",
        "verified_date": "2025-12-20",
        "notes": "Verified J.Crew oxford saves correctly"
      },
      {
        "id": "core-007",
        "name": "Closet tab - view logged try-ons",
        "status": "passing",
        "verified_date": "2025-12-20",
        "notes": "Renamed from History tab"
      },
      {
        "id": "core-008",
        "name": "Closet tab - pull to refresh",
        "status": "passing",
        "verified_date": "2025-12-20",
        "notes": ""
      },
      {
        "id": "core-009",
        "name": "Profile tab - user stats",
        "status": "passing",
        "verified_date": "2025-12-20",
        "notes": ""
      },
      {
        "id": "core-010",
        "name": "Profile tab - sign out",
        "status": "passing",
        "verified_date": "2025-12-20",
        "notes": ""
      },
      {
        "id": "core-011",
        "name": "Auth - sign in flow",
        "status": "passing",
        "verified_date": "2025-12-17",
        "notes": ""
      },
      {
        "id": "core-012",
        "name": "Auth - sign up flow",
        "status": "passing",
        "verified_date": "2025-12-17",
        "notes": ""
      }
    ]
  },

  "known_bugs": {
    "description": "Known issues to fix",
    "priority": "P1",
    "features": [
      {
        "id": "bug-001",
        "name": "URL matching requires exact match (AY960 != BE996)",
        "status": "failing",
        "notes": "Product URLs must match DB exactly - may need fuzzy matching"
      },
      {
        "id": "bug-002",
        "name": "48 products missing images (Uniqlo, rag & bone, Banana Republic)",
        "status": "failing",
        "notes": "Need to re-run scrapers with image extraction"
      }
    ]
  },

  "tech_debt": {
    "description": "Technical debt from Supabase advisor",
    "priority": "P2",
    "features": [
      {
        "id": "debt-001",
        "name": "Add indexes to 14 foreign keys",
        "status": "failing",
        "notes": "See Supabase advisor output"
      },
      {
        "id": "debt-002",
        "name": "Remove duplicate indexes",
        "status": "failing",
        "notes": ""
      },
      {
        "id": "debt-003",
        "name": "Fix RLS auth.uid() -> (select auth.uid())",
        "status": "failing",
        "notes": "Performance optimization"
      },
      {
        "id": "debt-004",
        "name": "Move pg_trgm to extensions schema",
        "status": "failing",
        "notes": "Security best practice"
      },
      {
        "id": "debt-005",
        "name": "Fix Banana Republic scraper schema (public -> core)",
        "status": "failing",
        "notes": ""
      },
      {
        "id": "debt-006",
        "name": "Re-scrape Club Monaco with color extraction",
        "status": "failing",
        "notes": "Extract hex from CSS filter-{color} classes via Playwright getComputedStyle"
      },
      {
        "id": "debt-007",
        "name": "Build brand_colors library for all brands",
        "status": "failing",
        "notes": "Scalable swatch fallback: swatch_url -> hex_code -> first letter"
      },
      {
        "id": "debt-008",
        "name": "Consolidate near-match product base_names",
        "status": "passing",
        "verified_date": "2025-12-21",
        "notes": "Fixed with brand_product_id approach. Consolidate by brand's product ID (e.g., 795806094) instead of title. Scalable for millions of products."
      }
    ]
  },

  "database_refactoring": {
    "description": "Database schema refactoring for scalability - 7 phases",
    "priority": "P1",
    "plan_file": ".claude/plans/database-refactoring-plan.md",
    "features": [
      {
        "id": "db-001",
        "name": "Phase 1: Size normalization schema",
        "status": "passing",
        "verified_date": "2025-12-21",
        "notes": "12 migrations: size_categories, canonical_sizes, brand_size_mappings, normalize_size_label()"
      },
      {
        "id": "db-002",
        "name": "Phase 2: Product consolidation schema",
        "status": "passing",
        "verified_date": "2025-12-21",
        "notes": "3 migrations: consolidation columns, audit log table, consolidate_products() function. Tested on Cotton Linen Twill Pant."
      },
      {
        "id": "db-003",
        "name": "Phase 3: Club Monaco product consolidation",
        "status": "passing",
        "verified_date": "2025-12-21",
        "notes": "51 products → 28 canonical + 23 merged. Added brand_product_id column for scalable consolidation. Near-match titles now consolidated (Johnny Collar Polo/Shirt → single product with 5 colors)."
      },
      {
        "id": "db-004",
        "name": "Phase 4: Uniqlo product consolidation",
        "status": "passing",
        "verified_date": "2025-12-21",
        "notes": "Backfilled brand_product_id. No consolidation needed - all 32 products have unique brand_product_ids (no color variants in current data)."
      },
      {
        "id": "db-005",
        "name": "Phase 5: Banana Republic migration",
        "status": "passing",
        "verified_date": "2025-12-21",
        "notes": "Products already in core.products. Backfilled brand_product_id, added missing URLs, fixed resolve_product_by_url for query-param URLs (?pid=XXXX), updated product_lookup to use brand_product_id for color matching. Deprecated old db_utils.py scraper infrastructure."
      },
      {
        "id": "db-006",
        "name": "Phase 6: Scraper updates",
        "status": "passing",
        "verified_date": "2025-12-21",
        "notes": "Added find_or_create_canonical_product() to Club Monaco and Uniqlo scrapers. Both now use brand_product_id to consolidate color variants into single products."
      },
      {
        "id": "db-007",
        "name": "Phase 7: Update product_lookup function",
        "status": "passing",
        "verified_date": "2025-12-21",
        "notes": "Added variant_id to user_garments. Updated save_tryon to save variant_id. Updated get_user_tryons to return color_name. Canonical filtering not needed - URLs already moved during consolidation."
      }
    ]
  },

  "phase_2_features": {
    "description": "Post-launch features for Phase 2",
    "priority": "P3",
    "features": [
      {
        "id": "p2-001",
        "name": "Size recommendations based on history",
        "status": "failing",
        "notes": ""
      },
      {
        "id": "p2-002",
        "name": "Polling feature - side-by-side voting",
        "status": "failing",
        "notes": ""
      },
      {
        "id": "p2-003",
        "name": "User URL submission with auto-scrape",
        "status": "failing",
        "notes": ""
      },
      {
        "id": "p2-004",
        "name": "Push notifications",
        "status": "failing",
        "notes": ""
      },
      {
        "id": "p2-005",
        "name": "Analytics integration (Mixpanel/Amplitude)",
        "status": "failing",
        "notes": ""
      },
      {
        "id": "p2-006",
        "name": "Scale scrapers from 7 to 50 brands",
        "status": "failing",
        "notes": ""
      }
    ]
  }
}
